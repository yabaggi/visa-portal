<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
  *{margin:0;padding:0;box-sizing:border-box;}

  :root{
    --primary:#1e40af;
    --accent:#3b82f6;
    --dark:#0f172a;
    --light:#f8fafc;
    --gray-100:#f1f5f9;
    --gray-200:#e2e8f0;
    --gray-400:#94a3b8;
    --gray-500:#64748b;
    --gray-600:#475569;
    --gray-800:#1e293b;
    --radius:16px;
    --shadow:0 20px 60px rgba(0,0,0,0.15);
  }

  body{
    font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
    background:var(--dark);
    color:#fff;
    min-height:100vh;
    overflow-x:hidden;
  }

  /* â”€â”€ RTL Support â”€â”€ */
  html[dir="rtl"] body{
    font-family:'Segoe UI',Tahoma,'Noto Sans Arabic','Droid Arabic Kufi',sans-serif;
  }
  html[dir="rtl"] .card-btn svg{
    transform:rotate(180deg);
  }

  /* â”€â”€ Language Toggle â”€â”€ */
  .lang-toggle{
    position:fixed;
    top:20px;
    right:20px;
    z-index:100;
    display:flex;
    background:rgba(255,255,255,0.08);
    backdrop-filter:blur(20px);
    -webkit-backdrop-filter:blur(20px);
    border:1px solid rgba(255,255,255,0.12);
    border-radius:30px;
    overflow:hidden;
    animation:fadeDown 0.8s ease;
  }

  html[dir="rtl"] .lang-toggle{
    right:auto;
    left:20px;
  }

  .lang-btn{
    padding:8px 18px;
    font-size:13px;
    font-weight:600;
    border:none;
    cursor:pointer;
    background:transparent;
    color:rgba(255,255,255,0.5);
    transition:all 0.3s;
    letter-spacing:0.5px;
  }

  .lang-btn.active{
    background:rgba(255,255,255,0.15);
    color:#fff;
  }

  .lang-btn:hover:not(.active){
    color:rgba(255,255,255,0.8);
  }

  /* â”€â”€ Hero Section â”€â”€ */
  .hero{
    position:relative;
    min-height:100vh;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    text-align:center;
    padding:40px 20px;
    overflow:hidden;
  }

  .hero-bg{
    position:absolute;
    inset:0;
    z-index:0;
  }

  .hero-bg img{
    width:100%;
    height:100%;
    object-fit:cover;
    opacity:0.3;
  }

  .hero-bg-gradient{
    position:absolute;
    inset:0;
    background:
      radial-gradient(ellipse at 20% 50%, rgba(30,64,175,0.4) 0%, transparent 60%),
      radial-gradient(ellipse at 80% 20%, rgba(59,130,246,0.3) 0%, transparent 50%),
      radial-gradient(ellipse at 50% 100%, rgba(15,23,42,0.9) 0%, transparent 60%),
      linear-gradient(180deg, rgba(15,23,42,0.7) 0%, rgba(15,23,42,0.4) 40%, rgba(15,23,42,0.8) 100%);
    z-index:1;
  }

  .hero-content{
    position:relative;
    z-index:2;
    max-width:800px;
    width:100%;
  }

  /* â”€â”€ Logo & Org â”€â”€ */
  .org-badge{
    display:inline-flex;
    align-items:center;
    gap:12px;
    background:rgba(255,255,255,0.08);
    backdrop-filter:blur(20px);
    -webkit-backdrop-filter:blur(20px);
    border:1px solid rgba(255,255,255,0.12);
    border-radius:60px;
    padding:10px 24px 10px 14px;
    margin-bottom:32px;
    animation:fadeDown 0.8s ease;
  }

  html[dir="rtl"] .org-badge{
    padding:10px 14px 10px 24px;
  }

  .org-logo{
    width:40px;
    height:40px;
    border-radius:50%;
    object-fit:cover;
    border:2px solid rgba(255,255,255,0.2);
  }

  .org-logo-placeholder{
    width:40px;
    height:40px;
    border-radius:50%;
    background:linear-gradient(135deg,var(--primary),var(--accent));
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:18px;
    font-weight:700;
    color:#fff;
    flex-shrink:0;
  }

  .org-name{
    font-size:15px;
    font-weight:600;
    letter-spacing:0.5px;
    text-transform:uppercase;
    color:rgba(255,255,255,0.9);
  }

  html[dir="rtl"] .org-name{
    letter-spacing:0;
  }

  /* â”€â”€ Typography â”€â”€ */
  .hero-title{
    font-size:clamp(32px,6vw,56px);
    font-weight:800;
    line-height:1.15;
    margin-bottom:20px;
    background:linear-gradient(135deg,#fff 30%,rgba(147,197,253,0.9));
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
    animation:fadeDown 0.8s ease 0.15s both;
  }

  html[dir="rtl"] .hero-title{
    line-height:1.4;
  }

  .hero-subtitle{
    font-size:clamp(16px,2.5vw,20px);
    color:rgba(255,255,255,0.65);
    line-height:1.6;
    max-width:600px;
    margin:0 auto 16px;
    animation:fadeDown 0.8s ease 0.3s both;
  }

  html[dir="rtl"] .hero-subtitle{
    line-height:1.8;
  }

  /* â”€â”€ Announcement â”€â”€ */
  .announcement{
    display:inline-block;
    background:rgba(251,191,36,0.15);
    border:1px solid rgba(251,191,36,0.3);
    color:#fbbf24;
    font-size:14px;
    padding:8px 20px;
    border-radius:30px;
    margin-bottom:40px;
    animation:fadeDown 0.8s ease 0.4s both;
  }

  /* â”€â”€ Cards â”€â”€ */
  .cards-container{
    display:flex;
    gap:20px;
    justify-content:center;
    flex-wrap:wrap;
    margin-top:40px;
    animation:fadeUp 0.8s ease 0.5s both;
  }

  .portal-card{
    background:rgba(255,255,255,0.06);
    backdrop-filter:blur(20px);
    -webkit-backdrop-filter:blur(20px);
    border:1px solid rgba(255,255,255,0.1);
    border-radius:var(--radius);
    padding:36px 32px;
    width:300px;
    text-align:center;
    cursor:pointer;
    transition:all 0.3s ease;
    position:relative;
    overflow:hidden;
  }

  .portal-card::before{
    content:'';
    position:absolute;
    inset:0;
    background:linear-gradient(135deg,transparent,rgba(59,130,246,0.08));
    opacity:0;
    transition:opacity 0.3s;
  }

  .portal-card:hover{
    transform:translateY(-6px);
    border-color:rgba(59,130,246,0.4);
    box-shadow:0 20px 50px rgba(59,130,246,0.15);
  }

  .portal-card:hover::before{opacity:1;}

  .card-icon{
    width:64px;
    height:64px;
    border-radius:16px;
    display:flex;
    align-items:center;
    justify-content:center;
    margin:0 auto 20px;
    font-size:28px;
    position:relative;
  }

  .card-icon.visa{
    background:linear-gradient(135deg,rgba(59,130,246,0.2),rgba(99,102,241,0.2));
    color:#60a5fa;
  }

  .card-icon.admin{
    background:linear-gradient(135deg,rgba(168,85,247,0.2),rgba(236,72,153,0.2));
    color:#c084fc;
  }

  .card-title{
    font-size:20px;
    font-weight:700;
    margin-bottom:10px;
    color:#fff;
  }

  .card-desc{
    font-size:14px;
    color:rgba(255,255,255,0.5);
    line-height:1.5;
    margin-bottom:24px;
  }

  .card-btn{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:12px 28px;
    border-radius:30px;
    font-size:15px;
    font-weight:600;
    border:none;
    cursor:pointer;
    transition:all 0.3s;
    text-decoration:none;
  }

  .card-btn.visa-btn{
    background:linear-gradient(135deg,var(--primary),var(--accent));
    color:#fff;
  }

  .card-btn.visa-btn:hover{
    box-shadow:0 8px 30px rgba(59,130,246,0.4);
    transform:translateY(-2px);
  }

  .card-btn.admin-btn{
    background:rgba(255,255,255,0.08);
    border:1px solid rgba(255,255,255,0.15);
    color:rgba(255,255,255,0.8);
  }

  .card-btn.admin-btn:hover{
    background:rgba(255,255,255,0.15);
    color:#fff;
  }

  /* â”€â”€ Stats â”€â”€ */
  .stats-bar{
    display:flex;
    gap:40px;
    justify-content:center;
    flex-wrap:wrap;
    margin-top:56px;
    padding-top:40px;
    border-top:1px solid rgba(255,255,255,0.08);
    animation:fadeUp 0.8s ease 0.7s both;
  }

  .stat-item{
    text-align:center;
  }

  .stat-number{
    font-size:28px;
    font-weight:800;
    background:linear-gradient(135deg,#60a5fa,#a78bfa);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
  }

  .stat-label{
    font-size:13px;
    color:rgba(255,255,255,0.4);
    margin-top:4px;
    text-transform:uppercase;
    letter-spacing:1px;
  }

  html[dir="rtl"] .stat-label{
    letter-spacing:0;
  }

  /* â”€â”€ Footer â”€â”€ */
  .footer{
    position:relative;
    z-index:2;
    text-align:center;
    padding:24px 20px;
    color:rgba(255,255,255,0.3);
    font-size:13px;
  }

  /* â”€â”€ Password Modal â”€â”€ */
  .modal-overlay{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.6);
    backdrop-filter:blur(8px);
    -webkit-backdrop-filter:blur(8px);
    z-index:1000;
    justify-content:center;
    align-items:center;
    padding:20px;
  }

  .modal-overlay.active{
    display:flex;
    animation:fadeIn 0.3s ease;
  }

  .modal-box{
    background:var(--gray-800);
    border:1px solid rgba(255,255,255,0.1);
    border-radius:var(--radius);
    padding:36px;
    width:100%;
    max-width:400px;
    text-align:center;
    animation:scaleIn 0.3s ease;
  }

  .modal-icon{
    width:56px;
    height:56px;
    border-radius:14px;
    background:linear-gradient(135deg,rgba(168,85,247,0.2),rgba(236,72,153,0.2));
    display:flex;
    align-items:center;
    justify-content:center;
    margin:0 auto 20px;
    font-size:24px;
  }

  .modal-title{
    font-size:20px;
    font-weight:700;
    margin-bottom:8px;
    color:#fff;
  }

  .modal-desc{
    font-size:14px;
    color:var(--gray-400);
    margin-bottom:24px;
  }

  .modal-input{
    width:100%;
    padding:14px 18px;
    background:rgba(255,255,255,0.06);
    border:1px solid rgba(255,255,255,0.12);
    border-radius:12px;
    color:#fff;
    font-size:15px;
    text-align:center;
    letter-spacing:3px;
    outline:none;
    transition:border-color 0.3s;
    margin-bottom:8px;
  }

  .modal-input:focus{
    border-color:var(--accent);
  }

  .modal-input.error{
    border-color:#ef4444;
    animation:shake 0.4s ease;
  }

  .modal-error{
    color:#ef4444;
    font-size:13px;
    min-height:20px;
    margin-bottom:16px;
  }

  .modal-btns{
    display:flex;
    gap:12px;
  }

  .modal-btn{
    flex:1;
    padding:12px;
    border-radius:12px;
    font-size:15px;
    font-weight:600;
    border:none;
    cursor:pointer;
    transition:all 0.3s;
  }

  .modal-btn.cancel{
    background:rgba(255,255,255,0.06);
    color:rgba(255,255,255,0.6);
  }

  .modal-btn.cancel:hover{
    background:rgba(255,255,255,0.1);
  }

  .modal-btn.submit{
    background:linear-gradient(135deg,#7c3aed,#a855f7);
    color:#fff;
  }

  .modal-btn.submit:hover{
    box-shadow:0 8px 25px rgba(168,85,247,0.3);
  }

  .modal-btn:disabled{
    opacity:0.5;
    cursor:not-allowed;
  }

  /* â”€â”€ Particles â”€â”€ */
  .particles{
    position:absolute;
    inset:0;
    z-index:1;
    overflow:hidden;
    pointer-events:none;
  }

  .particle{
    position:absolute;
    width:3px;
    height:3px;
    background:rgba(255,255,255,0.15);
    border-radius:50%;
    animation:float linear infinite;
  }

  /* â”€â”€ Animations â”€â”€ */
  @keyframes fadeDown{
    from{opacity:0;transform:translateY(-20px);}
    to{opacity:1;transform:translateY(0);}
  }

  @keyframes fadeUp{
    from{opacity:0;transform:translateY(20px);}
    to{opacity:1;transform:translateY(0);}
  }

  @keyframes fadeIn{
    from{opacity:0;}
    to{opacity:1;}
  }

  @keyframes scaleIn{
    from{opacity:0;transform:scale(0.9);}
    to{opacity:1;transform:scale(1);}
  }

  @keyframes shake{
    0%,100%{transform:translateX(0);}
    25%{transform:translateX(-8px);}
    50%{transform:translateX(8px);}
    75%{transform:translateX(-4px);}
  }

  @keyframes float{
    0%{transform:translateY(100vh) rotate(0deg);opacity:0;}
    10%{opacity:1;}
    90%{opacity:1;}
    100%{transform:translateY(-10vh) rotate(720deg);opacity:0;}
  }

  /* â”€â”€ Responsive â”€â”€ */
  @media(max-width:680px){
    .cards-container{flex-direction:column;align-items:center;}
    .portal-card{width:100%;max-width:340px;}
    .stats-bar{gap:24px;}
    .stat-number{font-size:24px;}
    .lang-toggle{top:12px;right:12px;}
    html[dir="rtl"] .lang-toggle{right:auto;left:12px;}
  }
</style>
</head>
<body>

<!-- Language Toggle -->
<div class="lang-toggle">
  <button class="lang-btn active" id="langEN" onclick="switchLang('en')">EN</button>
  <button class="lang-btn" id="langAR" onclick="switchLang('ar')">Ø¹Ø±Ø¨ÙŠ</button>
</div>

<div class="hero">
  <!-- Background -->
  <div class="hero-bg">
    <img id="heroBgImg" src="" alt="" style="display:none;">
    <div class="hero-bg-gradient"></div>
  </div>

  <!-- Floating Particles -->
  <div class="particles" id="particles"></div>

  <!-- Content -->
  <div class="hero-content">
    <!-- Org Badge -->
    <div class="org-badge">
      <div id="orgLogoWrap"></div>
      <span class="org-name" id="orgNameText">Loading...</span>
    </div>

    <!-- Title -->
    <h1 class="hero-title" id="heroTitle">Welcome to the Official Visa Portal</h1>
    <p class="hero-subtitle" id="heroSubtitle">Fast, secure, and transparent visa processing</p>

    <!-- Announcement -->
    <div class="announcement" id="announcement" style="display:none;"></div>

    <!-- Portal Cards -->
    <div class="cards-container">
      <!-- Visa Application Card -->
      <div class="portal-card" onclick="goToPortal()">
        <div class="card-icon visa">
          <svg width="28" height="28" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><rect x="2" y="3" width="20" height="18" rx="3"/><line x1="2" y1="9" x2="22" y2="9"/><circle cx="8" cy="15" r="2"/><line x1="14" y1="13" x2="19" y2="13"/><line x1="14" y1="16" x2="18" y2="16"/></svg>
        </div>
        <h3 class="card-title" id="portalBtnText">Apply for Visa</h3>
        <p class="card-desc" id="portalDesc">Submit your visa application online with our streamlined digital process</p>
        <span class="card-btn visa-btn">
          <span id="portalGetStarted">Get Started</span>
          <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </span>
      </div>

      <!-- Admin Card -->
      <div class="portal-card" onclick="showPasswordModal()">
        <div class="card-icon admin">
          <svg width="28" height="28" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/><circle cx="12" cy="16" r="1"/></svg>
        </div>
        <h3 class="card-title" id="adminBtnText">Admin Portal</h3>
        <p class="card-desc" id="adminDesc">Manage applications, review submissions, and control system settings</p>
        <span class="card-btn admin-btn">
          <span id="adminSignIn">Sign In</span>
          <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </span>
      </div>
    </div>

    <!-- Stats -->
    <div class="stats-bar">
      <div class="stat-item">
        <div class="stat-number">24/7</div>
        <div class="stat-label" id="statAvailable">Available</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">100%</div>
        <div class="stat-label" id="statDigital">Digital</div>
      </div>
      <div class="stat-item">
        <div class="stat-number" id="statFastNum">Fast</div>
        <div class="stat-label" id="statProcessing">Processing</div>
      </div>
      <div class="stat-item">
        <div class="stat-number" id="statSecureNum">Secure</div>
        <div class="stat-label" id="statEncrypted">& Encrypted</div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer" id="footerText"></div>
</div>

<!-- Password Modal -->
<div class="modal-overlay" id="passwordModal">
  <div class="modal-box">
    <div class="modal-icon">ğŸ”</div>
    <h3 class="modal-title" id="modalTitle">Admin Access</h3>
    <p class="modal-desc" id="modalDesc">Enter the administrator password to continue</p>
    <input type="password" class="modal-input" id="adminPwdInput" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" maxlength="50" onkeydown="if(event.key==='Enter')verifyPassword();" oninput="clearError();">
    <div class="modal-error" id="pwdError"></div>
    <div class="modal-btns">
      <button class="modal-btn cancel" onclick="hidePasswordModal()" id="modalCancel">Cancel</button>
      <button class="modal-btn submit" id="pwdSubmitBtn" onclick="verifyPassword()">Access</button>
    </div>
  </div>
</div>

<script>
  var APP_URL = '';
  var settings = {};
  var allSettings = { en: {}, ar: {} };
  var currentLang = 'en';

  // Static UI translations (for elements not in admin settings)
  var uiStrings = {
    en: {
      portalDesc: 'Submit your visa application online with our streamlined digital process',
      adminDesc: 'Manage applications, review submissions, and control system settings',
      getStarted: 'Get Started',
      signIn: 'Sign In',
      statAvailable: 'Available',
      statDigital: 'Digital',
      statFast: 'Fast',
      statProcessing: 'Processing',
      statSecure: 'Secure',
      statEncrypted: '& Encrypted',
      modalTitle: 'Admin Access',
      modalDesc: 'Enter the administrator password to continue',
      modalCancel: 'Cancel',
      modalAccess: 'Access',
      modalVerifying: 'Verifying...',
      modalPwdEmpty: 'Please enter a password',
      modalPwdWrong: 'Incorrect password'
    },
    ar: {
      portalDesc: 'Ù‚Ø¯Ù‘Ù… Ø·Ù„Ø¨ Ø§Ù„ØªØ£Ø´ÙŠØ±Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹ Ø¹Ø¨Ø± Ù†Ø¸Ø§Ù…Ù†Ø§ Ø§Ù„Ø±Ù‚Ù…ÙŠ Ø§Ù„Ù…Ø¨Ø³Ù‘Ø·',
      adminDesc: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆÙ…Ø±Ø§Ø¬Ø¹ØªÙ‡Ø§ ÙˆØ§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…',
      getStarted: 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†',
      signIn: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
      statAvailable: 'Ù…ØªØ§Ø­',
      statDigital: 'Ø±Ù‚Ù…ÙŠ',
      statFast: 'Ø³Ø±ÙŠØ¹',
      statProcessing: 'Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©',
      statSecure: 'Ø¢Ù…Ù†',
      statEncrypted: 'ÙˆÙ…Ø´ÙÙ‘Ø±',
      modalTitle: 'Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©',
      modalDesc: 'Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©',
      modalCancel: 'Ø¥Ù„ØºØ§Ø¡',
      modalAccess: 'Ø¯Ø®ÙˆÙ„',
      modalVerifying: 'Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù‚Ù‚...',
      modalPwdEmpty: 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±',
      modalPwdWrong: 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©'
    }
  };

  // â”€â”€ Initialize â”€â”€
  (function init() {
    createParticles();

    google.script.run
      .withSuccessHandler(function(url) { APP_URL = url; })
      .getWebAppUrl();

    // Load both EN and AR settings in one call
    google.script.run
      .withSuccessHandler(function(s) {
        allSettings.en = (s && s.en) || {};
        allSettings.ar = (s && s.ar) || {};
        settings = allSettings.en;
        applySettings();
      })
      .withFailureHandler(function() {
        applySettings();
      })
      .getAllLandingSettings();
  })();

  // â”€â”€ Language Switching â”€â”€
  function switchLang(lang) {
    currentLang = lang;

    // Toggle button states
    document.getElementById('langEN').classList.toggle('active', lang === 'en');
    document.getElementById('langAR').classList.toggle('active', lang === 'ar');

    // Set direction
    var html = document.documentElement;
    if (lang === 'ar') {
      html.setAttribute('dir', 'rtl');
      html.setAttribute('lang', 'ar');
    } else {
      html.setAttribute('dir', 'ltr');
      html.setAttribute('lang', 'en');
    }

    // Merge: AR overrides EN for text fields, EN stays for colors/images/password
    if (lang === 'ar') {
      settings = {};
      // Start with EN (has colors, images, password, etc.)
      for (var k in allSettings.en) { settings[k] = allSettings.en[k]; }
      // Override text fields with AR values (only if non-empty)
      var textKeys = ['orgName','tagline','heroTitle','heroSubtitle','portalButtonText',
                      'adminButtonText','footerText','announcementText'];
      for (var i = 0; i < textKeys.length; i++) {
        var key = textKeys[i];
        if (allSettings.ar[key]) settings[key] = allSettings.ar[key];
      }
    } else {
      settings = allSettings.en;
    }

    applySettings();
    applyUIStrings();
  }

  function applyUIStrings() {
    var s = uiStrings[currentLang];
    document.getElementById('portalDesc').textContent = s.portalDesc;
    document.getElementById('adminDesc').textContent = s.adminDesc;
    document.getElementById('portalGetStarted').textContent = s.getStarted;
    document.getElementById('adminSignIn').textContent = s.signIn;
    document.getElementById('statAvailable').textContent = s.statAvailable;
    document.getElementById('statDigital').textContent = s.statDigital;
    document.getElementById('statFastNum').textContent = s.statFast;
    document.getElementById('statProcessing').textContent = s.statProcessing;
    document.getElementById('statSecureNum').textContent = s.statSecure;
    document.getElementById('statEncrypted').textContent = s.statEncrypted;
    document.getElementById('modalTitle').textContent = s.modalTitle;
    document.getElementById('modalDesc').textContent = s.modalDesc;
    document.getElementById('modalCancel').textContent = s.modalCancel;
    document.getElementById('pwdSubmitBtn').textContent = s.modalAccess;
  }

  function applySettings() {
    var s = settings;

    // Org name
    document.getElementById('orgNameText').textContent = s.orgName || 'Republic of Veridian';

    // Logo
    var logoWrap = document.getElementById('orgLogoWrap');
    var logoUrl = s.logoUrl || allSettings.en.logoUrl;
    var orgChar = (s.orgName || 'V').charAt(0);
    if (logoUrl) {
      logoWrap.innerHTML = '<img class="org-logo" src="' + logoUrl + '" onerror="this.outerHTML=\'<div class=org-logo-placeholder>' + orgChar + '</div>\'">';
    } else {
      logoWrap.innerHTML = '<div class="org-logo-placeholder">' + orgChar + '</div>';
    }

    // Hero
    document.getElementById('heroTitle').textContent = s.heroTitle || 'Welcome to the Official Visa Portal';
    document.getElementById('heroSubtitle').textContent = s.heroSubtitle || 'Fast, secure, and transparent visa processing for travelers worldwide';

    // Hero background image
    var heroUrl = s.heroImageUrl || allSettings.en.heroImageUrl;
    if (heroUrl) {
      var img = document.getElementById('heroBgImg');
      img.src = heroUrl;
      img.style.display = 'block';
    }

    // Buttons
    document.getElementById('portalBtnText').textContent = s.portalButtonText || 'Apply for Visa';
    document.getElementById('adminBtnText').textContent = s.adminButtonText || 'Admin Portal';

    // Announcement
    var annText = s.announcementText;
    var ann = document.getElementById('announcement');
    if (annText) {
      ann.textContent = annText;
      ann.style.display = 'inline-block';
    } else {
      ann.style.display = 'none';
    }

    // Footer
    document.getElementById('footerText').textContent = s.footerText || 'Â© 2026 Visa Portal';

    // Colors (always from EN)
    var pc = allSettings.en.primaryColor || s.primaryColor;
    var ac = allSettings.en.accentColor || s.accentColor;
    if (pc) document.documentElement.style.setProperty('--primary', pc);
    if (ac) document.documentElement.style.setProperty('--accent', ac);

    // Update page title
    document.title = (s.orgName || 'Visa') + ' â€” Visa Portal';

    // Apply UI strings for current language
    applyUIStrings();
  }

  // â”€â”€ Navigation â”€â”€
  function goToPortal() {
    document.body.innerHTML = '<div style="display:flex;justify-content:center;align-items:center;height:100vh;color:#fff;font-size:18px;">' + (currentLang === 'ar' ? 'Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªØ£Ø´ÙŠØ±Ø©...' : 'Loading Visa Portal...') + '</div>';
    google.script.run
      .withSuccessHandler(function(html) {
        document.open();
        document.write(html);
        document.close();
      })
      .withFailureHandler(function(err) {
        alert('Error loading portal: ' + err.message);
      })
      .getPageContent('portal');
  }

  function goToAdmin() {
    document.body.innerHTML = '<div style="display:flex;justify-content:center;align-items:center;height:100vh;color:#fff;font-size:18px;">' + (currentLang === 'ar' ? 'Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©...' : 'Loading Admin Portal...') + '</div>';
    google.script.run
      .withSuccessHandler(function(html) {
        document.open();
        document.write(html);
        document.close();
      })
      .withFailureHandler(function(err) {
        alert('Error loading portal: ' + err.message);
      })
      .getPageContent('admin');
  }

  // â”€â”€ Password Modal â”€â”€
  function showPasswordModal() {
    document.getElementById('passwordModal').classList.add('active');
    document.getElementById('adminPwdInput').value = '';
    document.getElementById('pwdError').textContent = '';
    document.getElementById('adminPwdInput').classList.remove('error');
    setTimeout(function() {
      document.getElementById('adminPwdInput').focus();
    }, 300);
  }

  function hidePasswordModal() {
    document.getElementById('passwordModal').classList.remove('active');
  }

  function clearError() {
    document.getElementById('adminPwdInput').classList.remove('error');
    document.getElementById('pwdError').textContent = '';
  }

  function verifyPassword() {
    var str = uiStrings[currentLang];
    var pwd = document.getElementById('adminPwdInput').value.trim();
    if (!pwd) {
      document.getElementById('pwdError').textContent = str.modalPwdEmpty;
      document.getElementById('adminPwdInput').classList.add('error');
      return;
    }

    var btn = document.getElementById('pwdSubmitBtn');
    btn.disabled = true;
    btn.textContent = str.modalVerifying;

    google.script.run
      .withSuccessHandler(function(valid) {
        btn.disabled = false;
        btn.textContent = str.modalAccess;
        if (valid) {
          goToAdmin();
        } else {
          document.getElementById('pwdError').textContent = str.modalPwdWrong;
          document.getElementById('adminPwdInput').classList.add('error');
          document.getElementById('adminPwdInput').value = '';
          document.getElementById('adminPwdInput').focus();
        }
      })
      .withFailureHandler(function(err) {
        btn.disabled = false;
        btn.textContent = str.modalAccess;
        document.getElementById('pwdError').textContent = 'Error: ' + (err.message || 'Try again');
      })
      .verifyAdminPassword(pwd);
  }

  // Close modal on overlay click
  document.getElementById('passwordModal').addEventListener('click', function(e) {
    if (e.target === this) hidePasswordModal();
  });

  // â”€â”€ Particles â”€â”€
  function createParticles() {
    var container = document.getElementById('particles');
    for (var i = 0; i < 30; i++) {
      var p = document.createElement('div');
      p.className = 'particle';
      p.style.left = Math.random() * 100 + '%';
      p.style.animationDuration = (8 + Math.random() * 15) + 's';
      p.style.animationDelay = (Math.random() * 10) + 's';
      p.style.width = p.style.height = (2 + Math.random() * 3) + 'px';
      container.appendChild(p);
    }
  }
</script>

</body>
</html>

